<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>my_information</title>
    <link rel="stylesheet" href="../src/css/personal_information.css">
</head>

<body>
    <div class="background">
        <div class="intro">
            <img class="my_photo" id='user_head'>
            <p class="user_info"><label class="userinfo" id="user_name"></label></p>
            <p class="user_info"><label class="userinfo" id="user_id"></label></p>
            <div class="share">分享</div>
        </div>
    </div>
    <div class="content">
        <div class="part1">
            <p class="content_style">昵称</p>
            <label class="input_style" id="user_fake_name" onclick="javascrtpt:window.location.href='name_modify.html'"></label>
        </div>
        <!-- <hr> -->
        <div class="part1">
            <p class="content_style">性别</p>
            <label class="input_style" id="user_gender" onclick="javascrtpt:window.location.href='gender_modify.html'">请选择性别</label>
        </div>
        <!-- <hr> -->
        <div class="part1">
            <p class="content_style">出生日期</p>
            <label class="input_style" id="user_birthday" onclick="javascrtpt:window.location.href='birthday_modify.html'">请选择日期</label>
        </div>
        <!-- <hr> -->
        <div class="part1">
            <p class="content_style">所属年级</p>
            <label class="input_style" id="user_class" onclick="javascrtpt:window.location.href='class_modify.html'">请选择年级</label>
        </div>
        <div class="part2">
            <button type="submit" class="modify_submit" onclick="personal_information_modify()"><p class="style1">确定</p></button>
        </div>
    </div>
    <div id="qrcode" style="display:none"></div>

    <script src="../src/modules/jquery/jquery-3.3.1.min.js"></script>
    <script>

        var user={
                "result":true,
                "user_vip_expiration_time":1554028433000,
                "user_sex":"男",
                "user_birthday":832089600000,
                "user_name":"苏子棚",
                "user_is_it_vip":"1",
                "user_student_id":100001,
                "user_head_portrait_url":"http://szpstore.oss-cn-beijing.aliyuncs.com/szp.jpg?Expires=1554214940&OSSAccessKeyId=LTAINIcvCcsIqETW&Signature=T25xzgVlZiyvc7weKvdR8Y2S99U%3D",
                "user_grade":null
            }
        // if(localStorage.length==0){
        //     // localStorage.clear()
        //     localStorage.setItem('user_fake_name',user.user_name)
        //     localStorage.setItem('user_gender',user.user_sex)
        //     localStorage.setItem('user_birthday',user.user_birthday)
        //     localStorage.setItem('user_grade',user.user_grade)
        // }
        getLocalStroage('user_fake_name',user.user_name)
        getLocalStroage('user_gender',user.user_sex)
        getLocalStroage('user_birthday',user.user_birthday)
        getLocalStroage('user_grade',user.user_grade)

        function getLocalStroage(name, value){
            if(localStorage.getItem(name)==null){
                localStorage.setItem(name,value)
            }
            return localStorage.getItem(name);
        }

        $('#user_name').html(localStorage.getItem('user_fake_name'))
        $('#user_id').html('学号:'+user.user_student_id)
        $('#user_head').attr('src',user.user_head_portrait_url)
        $('#user_fake_name').html(localStorage.getItem('user_fake_name'))

     </script>

    <script src="../src/modules/qrcode/qrcode.min.js"></script>
    <script>
        $('.share').on('click',function(){
            var userid = '1'
            // qrcode
            var qrcode = new QRCode(document.getElementById("qrcode"), {
                text: "http://47.104.98.184:8080/GreenJujubeApp/invite?id="+userid,
                width: 128,
                height: 128,
                colorDark : "#000000",
                colorLight : "#ffffff",
                correctLevel : QRCode.CorrectLevel.L
            });
            $('#qrcode').show()
        })
        //提交代码
        function personal_information_modify(){
            $.ajax({
                url: "http://47.104.98.184:8080/GreenJujubeApp/updateuserinfo",
                async: true,
                type: "post",
                dataType: "json",
                data: {
                    "user_id": 1,
                    "name":"dogying",
                    "gender":"女",
                    "birthday":"1554796198000",
                    "grade":"1"


                },
                success: function (res) {
                    console.log(res);
                    //执行页面渲染
                    
                    // ...
                },
                error: function (res) {
                    console.log(res)
                    //执行页面刷新提示让用户刷新
                    // var data = AJAXcomments2data
                    // renderComments(data)
                }
            })
        }
    </script>
</body>

</html>